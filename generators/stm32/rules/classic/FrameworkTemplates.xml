<?xml version="1.0"?>
<FamilyDefinition xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
	<AdditionalFrameworks>
		<Framework>
			<!-- Warning: some parts of the HAL library depend on functions implemented in the LL library, hence HAL-based projects now must reference both HAL and LL frameworks. -->
			<Name>$$STM32:FAMILY_EX$$ HAL Library</Name>
			<ID>com.sysprogs.arm.stm32.$$STM32:FAMILY_EX$$_hal</ID>
			<ClassID>com.sysprogs.arm.stm32.hal</ClassID>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.$$STM32:FAMILY_EX$$_ll</string>
			</RequiredFrameworks>
			<ProjectFolderName>HAL</ProjectFolderName>
			<DefaultEnabled>true</DefaultEnabled>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Drivers\$$STM32:FAMILY$$xx_HAL_Driver</SourceFolder>
					<FilesToCopy>*.c;*.h</FilesToCopy>
					<!-- Note: stm32xxxx_ll_usb.c actually requires HAL headers -->
					<!-- Note: "&gt;" (i.e. ">") before the mask below means "treat the rest of the mask as a regex" -->
					<ProjectInclusionMask>-*_template.?;*stm32??xx_ll_usb.?;-&gt;.*stm32[^\\]+_ll_[^\\]+$;*</ProjectInclusionMask>
					<AdvancedRenameRules>legacy\\(stm32..xx_hal_[^.]+)\.c$=>{1}_legacy.c</AdvancedRenameRules>
				</CopyJob>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Drivers\CMSIS</SourceFolder>
					<FilesToCopy>-*Examples\*;-DSP\*;-DSP_Lib\*;*.h;*.c</FilesToCopy>
					<TargetFolder>CMSIS_HAL</TargetFolder>
					<PreprocessorMacros>$$com.sysprogs.stm32.hal_device_family$$;USE_HAL_DRIVER</PreprocessorMacros>
					<ProjectInclusionMask>-Examples\*;-RTOS2\*;-Core\Template\*;-Core_A\*;-NN\*;-DAP\*;-*Include\stm32??????.h*;-*system_*.c;-*\mmu_lpae_*.c;-*\startup_*.c;*</ProjectInclusionMask>
					<AutoIncludeMask>-Examples\*;-RTOS\Template\*;-RTOS2\Template\*;-NN\*;-DAP\*;-Core_A\*;*.h</AutoIncludeMask>					
				</CopyJob>
			</CopyJobs>
			<ConfigFiles>
				<ConfigFileDefinition>
					<Path>$$STM32:FAMILY_DIR$$\Drivers\$$STM32:FAMILY$$xx_HAL_Driver\Inc\$$STM32:FAMILY_L$$xx_hal_conf_template.h</Path>
					<TargetPathForInsertingIntoProject>$$STM32:TARGET_FAMILY_DIR$$/$$STM32:FAMILY$$xx_HAL_Driver/Inc/$$STM32:FAMILY_L$$xx_hal_conf_template.h</TargetPathForInsertingIntoProject>
					<FinalName>$$STM32:FAMILY_L$$xx_hal_conf.h</FinalName>
					<ParserClass>stm32_bsp_generator.STM32ConfigFileParser</ParserClass>
					<TestableHeaderFiles>
						<string>$$STM32:FAMILY_L$$xx_hal.h</string>
					</TestableHeaderFiles>
				</ConfigFileDefinition>
			</ConfigFiles>
		</Framework>
		<Framework>
			<Name>$$STM32:FAMILY_EX$$ Low-level Driver Library</Name>
			<ID>com.sysprogs.arm.stm32.$$STM32:FAMILY_EX$$_ll</ID>
			<ClassID>com.sysprogs.arm.stm32.ll</ClassID>
			<ProjectFolderName>LL</ProjectFolderName>
			<DefaultEnabled>true</DefaultEnabled>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Drivers\$$STM32:FAMILY$$xx_HAL_Driver</SourceFolder>
					<SmartPropertyGroup>com.sysprogs.bspoptions.stm32.ll_|Low-level Driver Library</SmartPropertyGroup>
					<SmartPreprocessorMacros>
						<string>-Enable Advanced Low-Level Driver Functions[driver]|{0}|USE_FULL_LL_DRIVER</string>
					</SmartPreprocessorMacros>

					<FilesToCopy>*.c;*.h</FilesToCopy>
					<!-- Note: "&gt;" (i.e. ">") before the mask below means "treat the rest of the mask as a regex" -->
					<ProjectInclusionMask>-*stm32??xx_ll_usb.?;&gt;.*stm32[^\\]+_ll_[^\\]+\.(h|c|cpp)</ProjectInclusionMask>
					<PreprocessorMacros>$$com.sysprogs.stm32.hal_device_family$$</PreprocessorMacros>
					<AlreadyCopied>true</AlreadyCopied>
					<AdditionalIncludeDirs>Inc;$$STM32:TARGET_FAMILY_DIR$$/CMSIS_HAL/Device/ST/$$STM32:FAMILY$$xx/Include;$$STM32:TARGET_FAMILY_DIR$$/CMSIS_HAL/Core/Include;$$STM32:TARGET_FAMILY_DIR$$/CMSIS_HAL/Include</AdditionalIncludeDirs>
				</CopyJob>
			</CopyJobs>			
		</Framework>
		<Framework>
			<Name>$$STM32:FAMILY_EX$$ Default System Init File</Name>
			<ID>com.sysprogs.arm.stm32.$$STM32:FAMILY_EX$$_systeminit</ID>
			<ClassID>com.sysprogs.arm.stm32.hal_systeminit</ClassID>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.$$STM32:FAMILY_EX$$_hal</string>
			</RequiredFrameworks>
			<ProjectFolderName>SystemInit</ProjectFolderName>
			<DefaultEnabled>true</DefaultEnabled>
			<CopyJobs>
				<CopyJob>
					<AlreadyCopied>true</AlreadyCopied>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Drivers\CMSIS</SourceFolder>
					<TargetFolder>CMSIS_HAL</TargetFolder>
					<FilesToCopy>-*NN_Lib_Tests*;*system_stm*.c</FilesToCopy>
				</CopyJob>
			</CopyJobs>			
		</Framework>
		<Framework>
			<Name>STM32 USB Device Library</Name>
			<ID>com.sysprogs.arm.stm32.usbdev.$$STM32:FAMILY_EX$$</ID>
			<ClassID>com.sysprogs.arm.stm32.usbdev</ClassID>
			<ProjectFolderName>USB Device</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\STM32_USB_Device_Library</SourceFolder>
					<FilesToCopy>*.c;*.h</FilesToCopy>
					<ProjectInclusionMask>-*template.c;-*template.h;*</ProjectInclusionMask>
					<SmartPropertyGroup>com.sysprogs.bspoptions.stm32.usb.|USB Device</SmartPropertyGroup>
					<SmartFileConditions>
						<string>-Audio Device Support[devclass.audio]|Class\\AUDIO\\.*</string>
						<string>-Billboard Device Support[devclass.billboard]|Class\\BillBoard\\.*</string>
						<string>-Integrated Circuit Card (CCID) Support[devclass.ccid]|Class\\CCID\\.*</string>
						<string>Communications Device (CDC) Support[devclass.cdc]|Class\\CDC\\.*</string>
						<string>-Composite Descriptor Builder[devclass.composite_builder]|Class\\CompositeBuilder\\.*</string>
						<string>-Ethernet Control Model (ECM) Support[devclass.ecm]|Class\\CDC_ECM\\.*</string>
						<string>-Remote NDIS (RNDIS) Support[devclass.rndis]|Class\\CDC_RNDIS\\.*</string>
						<string>-Custom Human Interface Device (CustomHID) Support[devclass.customhid]|Class\\CustomHID\\.*</string>
						<string>-Device Firmware Update (DFU) Support[devclass.dfu]|Class\\DFU\\.*</string>
						<string>-Human Interface Device (HID)[devclass.hid]|Class\\HID\\.*</string>
						<string>-Mass Storage (MSC) Support[devclass.msc]|Class\\MSC\\.*</string>
						<string>-Media Transfer Protocol (MTP) Support[devclass.mtp]|Class\\MTP\\.*</string>
						<string>-Printer Support[devclass.printer]|Class\\Printer\\.*</string>
						<string>-Video Device Support[devclass.video]|Class\\VIDEO\\.*</string>
					</SmartFileConditions>
					<SmartPreprocessorMacros>
						<string>USB Device Speed[speed]|USE_USB_{0}|FS=>USB 2.0 Full Speed;HS=>USB 2.0 High Speed</string>
					</SmartPreprocessorMacros>
					<Patches>
						<Patch xsi:type="InsertLines">
							<FilePath>core\src\usbd_core.c</FilePath>
							<AfterLine>#include "usbd_core.h"</AfterLine>
							<InsertedLines>
								<string>#ifndef UNUSED</string>
								<string>#define UNUSED(x) ((void)(x));</string>
								<string>#endif</string>															
							</InsertedLines>
						</Patch>											
					</Patches>
				</CopyJob>
			</CopyJobs>
		</Framework>
		<Framework>
			<Name>STM32 USB Host Library</Name>
			<ID>com.sysprogs.arm.stm32.usbhost.$$STM32:FAMILY_EX$$</ID>
			<ClassID>com.sysprogs.arm.stm32.usbhost</ClassID>
			<ProjectFolderName>USB Host</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\STM32_USB_Host_Library</SourceFolder>
					<FilesToCopy>*.c;*.h</FilesToCopy>
					<ProjectInclusionMask>-*template.c;-*template.h;*</ProjectInclusionMask>
					<PreprocessorMacros>USE_USB_$$com.sysprogs.bspoptions.stm32.usb.speed$$</PreprocessorMacros>
					<SimpleFileConditions>
						<string>Class\\MTP\\: $$com.sysprogs.bspoptions.stm32.usb.host.mtp$$ == 1</string>
						<string>Class\\MSC\\: $$com.sysprogs.bspoptions.stm32.usb.host.msc$$ == 1</string>
						<string>Class\\HID\\: $$com.sysprogs.bspoptions.stm32.usb.host.hid$$ == 1</string>
						<string>Class\\CDC\\: $$com.sysprogs.bspoptions.stm32.usb.host.cdc$$ == 1</string>
						<string>Class\\Audio\\: $$com.sysprogs.bspoptions.stm32.usb.host.audio$$ == 1</string>
					</SimpleFileConditions>
				</CopyJob>
			</CopyJobs>
			<ConfigurableProperties>
				<PropertyGroups>
				  <PropertyGroup>
					<Properties>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host Audio Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.audio</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host CDC Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.cdc</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host HID Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.hid</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host Mass Storage Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.msc</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
					  <PropertyEntry xsi:type="Boolean">
						<Name>USB Host MTP Support</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.usb.host.mtp</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
						<PropertyEntry xsi:type="Enumerated">
						  <Name>USB Device Speed</Name>
						  <UniqueID>com.sysprogs.bspoptions.stm32.usb.speed</UniqueID>
						  <Description>Specifies the USB peripheral (USB_FS vs USB_HS) used by the device</Description>
						  <SuggestionList>
							<Suggestion><InternalValue>FS</InternalValue><UserFriendlyName>USB 2.0 Full Speed</UserFriendlyName></Suggestion>
							<Suggestion><InternalValue>HS</InternalValue><UserFriendlyName>USB 2.0 High Speed</UserFriendlyName></Suggestion>
						  </SuggestionList>
						  <DefaultEntryIndex>0</DefaultEntryIndex>
						  <AllowFreeEntry>false</AllowFreeEntry>
						</PropertyEntry>
					</Properties>
					<CollapsedByDefault>false</CollapsedByDefault>
				  </PropertyGroup>
				</PropertyGroups>
			</ConfigurableProperties>			
		</Framework>
		<Framework>
			<Name>STM32 USB Power Delivery Support</Name>
			<ID>com.sysprogs.arm.stm32.usbpd.$$STM32:FAMILY_EX$$</ID>
			<ClassID>com.sysprogs.arm.stm32.usbpd</ClassID>
			<ProjectFolderName>USB Power Delivery</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\STM32_USBPD_Library</SourceFolder>
					<FilesToCopy>*</FilesToCopy>
					<ProjectInclusionMask>-*template.c;-*template.h;*.c;*.h</ProjectInclusionMask>
				</CopyJob>
			</CopyJobs>
		</Framework>
	<!-- Frameworks formerly reused between device families -->
		<Framework>
			<Name>FreeRTOS</Name>
			<ID>com.sysprogs.arm.stm32.freertos</ID>
			<ProjectFolderName>FreeRTOS</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\Third_Party\FreeRTOS</SourceFolder>
					<FilesToCopy>*.c;*.h;*.url;*.txt</FilesToCopy>
					<ProjectInclusionMask>-*template.c;-*template.h;-*.url;Source\Portable\MemMang\*;Source\portable\GCC\*;-Source\Portable\*;*</ProjectInclusionMask>
					<Flags>IgnoreFamilySubdir AutoTrimFileConditions</Flags>
					<AutoIncludeMask/>
					<PreprocessorMacros>USE_FREERTOS</PreprocessorMacros>
					<AdditionalIncludeDirs>$$SYS:BSP_ROOT$$/FreeRTOS/Source/$$com.sysprogs.bspoptions.stm32.freertos.cmsis$$;$$SYS:BSP_ROOT$$/FreeRTOS/Source/include;$$SYS:BSP_ROOT$$/FreeRTOS/Source/portable/GCC/ARM_$$com.sysprogs.bspoptions.stm32.freertos.portcore$$</AdditionalIncludeDirs>
					<Patches>
						<Patch xsi:type="ReplaceLine">
							<FilePath>Source\portable\GCC\ARM_CM4F\port.c</FilePath>
							<OldLine>#ifndef __VFP_FP__</OldLine>
							<NewLine>#if !defined(__VFP_FP__) || defined(__SOFTFP__)</NewLine>
						</Patch>
						<Patch xsi:type="ReplaceLine">
							<FilePath>Source\portable\GCC\ARM_CM4F\port.c</FilePath>
							<OldLine>	#error This port can only be used when the project options are configured to enable hardware floating point support.</OldLine>
							<NewLine>	#error This port can only be used when the project options are configured to enable hardware floating point support. Please switch to hardware FP or select a different FreeRTOS port on the Frameworks page of VisualGDB Project Properties.</NewLine>
						</Patch>
					</Patches>
					<SmartPropertyGroup>com.sysprogs.bspoptions.stm32.freertos.|FreeRTOS</SmartPropertyGroup>
					<SmartFileConditions>
						<string>Heap Implementation[heap]|
Source\\portable\\MemMang\\heap_1.c=>Heap1 - no support for freeing[heap_1];
Source\\portable\\MemMang\\heap_2.c=>Heap2 - no block consolidation[heap_2];
Source\\portable\\MemMang\\heap_3.c=>Heap3 - use newlib malloc()/free()[heap_3];
Source\\portable\\MemMang\\heap_4.c=>+Heap4 - contiguous heap area[heap_4];
Source\\portable\\MemMang\\heap_5.c=>Heap5 - scattered heap area[heap_5]
						</string>
						<string>--default=$$com.sysprogs.freertos.default_port$$|CPU Core support[portcore]|
Source\\portable\\GCC\\ARM_CA9\\.*=>ARM Cortex A9[CA9];
Source\\portable\\GCC\\ARM_CM0\\.*=>ARM Cortex M0[CM0];
Source\\portable\\GCC\\ARM_CM23_NTZ\\non_secure\\.*=>ARM Cortex M23 (no TrustZone)[CM23_NTZ/non_secure];
Source\\portable\\GCC\\ARM_CM23\\non_secure\\.*=>ARM Cortex M23 (TrustZone - non-secure partition)[CM23/non_secure]];
Source\\portable\\GCC\\ARM_CM23\\secure\\.*=>ARM Cortex M23 (TrustZone - secure partition)[CM23/secure];
Source\\portable\\GCC\\ARM_CM3\\.*=>+ARM Cortex M3 or M4 with Software FP[CM3];
Source\\portable\\GCC\\ARM_CM3_MPU\\.*=>ARM Cortex M3 with MPU[CM3_MPU];
Source\\portable\\GCC\\ARM_CM33\\non_secure\\.*=>ARM Cortex M33 (TrustZone - non-secure partition)[CM33/non_secure]];
Source\\portable\\GCC\\ARM_CM33\\secure\\.*=>ARM Cortex M33 (TrustZone - secure partitione)[CM33/secure];
Source\\portable\\GCC\\ARM_CM33_NTZ\\non_secure\\.*=>ARM Cortex M33 (no TrustZone)[CM33_NTZ/non_secure];
Source\\portable\\GCC\\ARM_CM4_MPU\\.*=>ARM Cortex M4 with MPU[CM4_MPU];
Source\\portable\\GCC\\ARM_CM4F\\.*=>ARM Cortex M4 with Hardware FP[CM4F];
Source\\portable\\GCC\\ARM_CM55\\non_secure\\.*=>ARM Cortex M55 (TrustZone - non-secure partition)[CM55/non_secure]];
Source\\portable\\GCC\\ARM_CM55\\secure\\.*=>ARM Cortex M55 (TrustZone - secure partitione)[CM55/secure];
Source\\portable\\GCC\\ARM_CM55_NTZ\\non_secure\\.*=>ARM Cortex M55 (no TrustZone)[CM55_NTZ/non_secure];
Source\\portable\\GCC\\ARM_CM7\\.*=>ARM Cortex M7[CM7/r0p1];
Source\\portable\\GCC\\ARM_CM7_MPU\\.*=>ARM Cortex M7 with MPU[CM7_MPU/r0p1];
Source\\portable\\GCC\\ARM_CM85\\non_secure\\.*=>ARM Cortex M85 (TrustZone - non-secure partition)[CM85/non_secure]];
Source\\portable\\GCC\\ARM_CM85\\secure\\.*=>ARM Cortex M85 (TrustZone - secure partitione)[CM85/secure];
Source\\portable\\GCC\\ARM_CM85_NTZ\\non_secure\\.*=>ARM Cortex M85 (no TrustZone)[CM85_NTZ/non_secure];
						</string>
						<string>CMSIS RTOS Interface Version[cmsis]|
Source\\CMSIS_RTOS\\.*=>v1[CMSIS_RTOS];
Source\\CMSIS_RTOS_V2\\.*=>v2[CMSIS_RTOS_V2];
						</string>
					</SmartFileConditions>
				</CopyJob>
			</CopyJobs>
			<ConfigFiles>
				<ConfigFileDefinition>
					<Path>$$STM32:FAMILY_DIR$$\Middlewares\Third_Party\FreeRTOS\source\include\FreeRTOSConfig_template.h</Path>
					<FinalName>FreeRTOSConfig.h</FinalName>
					<ParserClass>BSPGenerationTools.ConfigFiles.FreeRTOSConfigParser</ParserClass>
					<TargetPathForInsertingIntoProject>$$SYS:BSP_ROOT$$/FreeRTOS/Source/include/FreeRTOSConfig_template.h</TargetPathForInsertingIntoProject>
				</ConfigFileDefinition>
			</ConfigFiles>
			<AdditionalSystemVars>
				<SysVarEntry>
					<Key>com.sysprogs.rtos_type</Key>
					<Value>com.sysprogs.freertos</Value>
				</SysVarEntry>
			</AdditionalSystemVars>
		</Framework>
		<Framework>
			<Name>MbedTLS</Name>
			<ID>com.sysprogs.arm.stm32.mbedtls</ID>
			<ProjectFolderName>MbedTLS</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>		
			<CopyJobs>			
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\Third_Party\mbedTLS</SourceFolder>
					<FilesToCopy>include\mbedtls\*.h;library\*.c</FilesToCopy>
					<ProjectInclusionMask>-library\timing.c;-library\x509*;-library\templates\*;*.c;*.h</ProjectInclusionMask>
					<AutoIncludeMask/>
					<AdditionalIncludeDirs>$$SYS:BSP_ROOT$$/mbedtls/include</AdditionalIncludeDirs>
					<PreprocessorMacros>MBEDTLS_NO_PLATFORM_ENTROPY</PreprocessorMacros>
					<AdvancedRenameRules>library\\([^.\\]+)\.c$=>mbedtls_{1}.c</AdvancedRenameRules>
					<ExcludeFromVendorSampleMapping>true</ExcludeFromVendorSampleMapping> <!-- See lwIP -->
				</CopyJob>
			</CopyJobs>
		</Framework>	
		<Framework>
			<Name>LwIP</Name>
			<ID>com.sysprogs.arm.stm32.LwIP</ID>
			<ProjectFolderName>LwIP</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>			
			<CopyJobs>			
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\Third_Party\LwIP</SourceFolder>
					<FilesToCopy>*.c;*.h;*.txt</FilesToCopy>
					<Flags>IgnoreFamilySubdir</Flags>
					<ProjectInclusionMask>-doc\*;system\OS\sys_arch.c;-test\*;-system\*;-*template.c;-*template.h;-*\fsdata.c;-*\makefsdata\*;-*\ethernetif.c;-src\core\ipv6\*;-contrib\*;*.c;*.h</ProjectInclusionMask>
					<AutoIncludeMask/>
					<AdditionalIncludeDirs>$$SYS:BSP_ROOT$$/LwIP/src/include;$$SYS:BSP_ROOT$$/LwIP/system;$$SYS:BSP_ROOT$$/LwIP/src/include/ipv4</AdditionalIncludeDirs>
					<PreprocessorMacros>LWIP_IPV4;LWIP_TIMEVAL_PRIVATE=0</PreprocessorMacros>
					<SimpleFileConditions>
						<string>system\\OS\\sys_arch.c: fw:com.sysprogs.arm.stm32.freertos</string>
						<string>src\\netif\\ppp\\polarssl\\: $$com.sysprogs.bspoptions.stm32.lwip.pssl$$ == 1</string>
					</SimpleFileConditions>
					<ExcludeFromVendorSampleMapping>true</ExcludeFromVendorSampleMapping> <!-- Different SDKs have slightly different versions of lwIP with non-trivial include paths, so translating the paths automatically may break build -->
					<Patches>
						<Patch xsi:type="InsertLines">
							<FilePath>src\include\lwip\sockets.h</FilePath>
							<AfterLine>#endif /* LWIP_TIMEVAL_PRIVATE */</AfterLine>
							<InsertedLines>
								<string>#if LWIP_TIMEVAL_PRIVATE == 0 </string>
								<string>#include  &lt;sys/types.h&gt;</string>
								<string>#endif /* LWIP_TIMEVAL_PRIVATE */</string>															
							</InsertedLines>
						</Patch>											
					</Patches>
				</CopyJob>
			</CopyJobs>
				<ConfigurableProperties>
				<PropertyGroups>
				  <PropertyGroup>
				  	<Properties>
					  <PropertyEntry xsi:type="Boolean">
						<Name>Include PPP support via PolarSSL</Name>
						<UniqueID>com.sysprogs.bspoptions.stm32.lwip.pssl</UniqueID>
						<ValueForTrue>1</ValueForTrue>
						<ValueForFalse>0</ValueForFalse>
					  </PropertyEntry>
					<CollapsedByDefault>false</CollapsedByDefault>
					</Properties>
				  </PropertyGroup>
				</PropertyGroups>
			</ConfigurableProperties>	
		</Framework>
		<Framework>
			<Name>FatFs</Name>
			<ID>com.sysprogs.arm.stm32.FatFs</ID>
               <ConfigurationFileTemplates>
                    <ConfigurationFileTemplate>
                        <SourcePath>$$SYS:BSP_ROOT$$/FatFs/src/ffconf_template.h</SourcePath>
                        <TargetFileName>ffconf.h</TargetFileName>
                        <ExpandMacros>false</ExpandMacros>
                        </ConfigurationFileTemplate>
					</ConfigurationFileTemplates>				  
			<ProjectFolderName>FatFs</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>		
			<CopyJobs>			
				<CopyJob>
					<Flags>IgnoreFamilySubdir</Flags>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\Third_Party\FatFs</SourceFolder>
					<FilesToCopy>*.c;*.h;*.txt</FilesToCopy>
					<ProjectInclusionMask>-src\drivers\*;-src\option\cc*.c;-doc\*;*.c;*.h</ProjectInclusionMask>
					<AutoIncludeMask/>
					<AdditionalIncludeDirs>$$SYS:BSP_ROOT$$/FatFs/src;$$SYS:BSP_ROOT$$/FatFs/src/drivers</AdditionalIncludeDirs>
					<PreprocessorMacros></PreprocessorMacros>
				</CopyJob>
				<CopyJob>
					<Flags>IgnoreFamilySubdir</Flags>
					<SourceFolder>$$BSPGEN:RULES_DIR$$\\config</SourceFolder>
					<FilesToCopy>ffconf.h</FilesToCopy>
					<TargetFolder>BSP\ConfigTemplates</TargetFolder>
					<AutoIncludeMask/>
					<!--<AdditionalIncludeDirs>$$SYS:BSP_ROOT$$/STM32F7xxxx/BSP/STM32756G_EVAL</AdditionalIncludeDirs>-->
					<ProjectInclusionMask>*.h</ProjectInclusionMask>				
				</CopyJob>
			</CopyJobs>
		</Framework>		
		<Framework>
			<Name>STM32 Utilities</Name>
			<ID>com.sysprogs.arm.stm32.utilities</ID>
			<ProjectFolderName>Utilities</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Utilities</SourceFolder>
					<FilesToCopy>CPU\*;Fonts\*;Log\*;LCD\*;GUI_INTERFACE\*;TRACER_EMB\*</FilesToCopy>
					<SmartPropertyGroup>com.sysprogs.bspoptions.stm32.utils.|STM32 Utilities</SmartPropertyGroup>
					<ProjectInclusionMask>-*conf_template.h;*.c;*.h</ProjectInclusionMask>
					<Flags>IgnoreFamilySubdir AutoTrimFileConditions</Flags>
					<SmartFileConditions>
						<string>-CPU Usage Monitor (FreeRTOS)[cpu]|CPU\\.*</string>
						<string>-Fonts[fonts]|Fonts\\.*</string>
						<string>-LCD Drawing Functions[lcd]|LCD\\.*</string>
						<string>-LCD Logging Support[log]|Log\\.*</string>
						<string>-GUI Interface Functions[gui_iface]|GUI_INTERFACE\\.*</string>
						<string>-Tracing Functions[tracer]|TRACER_EMB\\.*</string>
					</SmartFileConditions>
				</CopyJob>
			</CopyJobs>
		</Framework>
		<Framework>
			<Name>STM32 Audio</Name>
			<ID>com.sysprogs.arm.stm32.audio</ID>
			<ProjectFolderName>Audio</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\STM32_Audio</SourceFolder>
					<Flags>IgnoreFamilySubdir</Flags>
					<TargetFolder>Middlewares\ST\STM32_Audio</TargetFolder>
					<FilesToCopy>*.c;*.h;*_GCC_*.a</FilesToCopy>
					<ProjectInclusionMask>*.c;*.h</ProjectInclusionMask>
				</CopyJob>
			</CopyJobs>
		</Framework>
		<Framework>
			<Name>AzureRTOS - ThreadX</Name>
			<ID>com.sysprogs.arm.stm32.threadx</ID>
			<ProjectFolderName>ThreadX</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\threadx</SourceFolder>
					<TargetFolder>AzureRTOS\threadx</TargetFolder>
					<FilesToCopy>*</FilesToCopy>
					<AutoIncludeMask/>
					<!-- tx_initialize_low_level.S included in m23/m33 ports is redundant against the sample projects -->
					<ProjectInclusionMask>common\*.c;common\*.h;-*\example_build\*;-*\tx_initialize_low_level.*;ports\cortex_*\gnu\*</ProjectInclusionMask>
					<SmartPropertyGroup>com.sysprogs.bspoptions.stm32.threadx.|ThreadX</SmartPropertyGroup>
					<ExcludeFromVendorSampleMapping>true</ExcludeFromVendorSampleMapping>
					<AdditionalIncludeDirs>common/inc;ports/cortex_$$com.sysprogs.bspoptions.arm.core$$/gnu/inc</AdditionalIncludeDirs>
					<SmartPreprocessorMacros>
						<string>Include user-provided definition file[user_define]|{0}|TX_INCLUDE_USER_DEFINE_FILE</string>
					</SmartPreprocessorMacros>
					<Flags>AutoTrimFileConditions IgnoreFamilySubdir</Flags>
					<SimpleFileConditions> 
						<string>ports\\cortex_a7\\.*:$$com.sysprogs.bspoptions.arm.core$$==A7</string>
						<string>ports\\cortex_m0\\.*:$$com.sysprogs.bspoptions.arm.core$$==M0</string>
						<string>ports\\cortex_m3\\.*:$$com.sysprogs.bspoptions.arm.core$$==M3</string>
						<string>ports\\cortex_m4\\.*:$$com.sysprogs.bspoptions.arm.core$$==M4</string>
						<string>ports\\cortex_m7\\.*:$$com.sysprogs.bspoptions.arm.core$$==M7</string>
						<string>ports\\cortex_m23\\.*:$$com.sysprogs.bspoptions.arm.core$$==M23</string>
						<string>ports\\cortex_m33\\.*:$$com.sysprogs.bspoptions.arm.core$$==M33</string>
						<string>ports\\cortex_m55\\.*:$$com.sysprogs.bspoptions.arm.core$$==M55</string>
						<string>ports\\cortex_m85\\.*:$$com.sysprogs.bspoptions.arm.core$$==M85</string>
						<string>common\\src\\tx_thread_stack_error_(handler|notify)\.[ch]:$$com.sysprogs.bspoptions.arm.core$$=~[AM][0-9]$</string>
					</SimpleFileConditions>
					<AdvancedRenameRules>\\(tx_misra)\.c$=>{1}_c.c</AdvancedRenameRules>					
				</CopyJob>
			</CopyJobs>
			<AdditionalSystemVars>
				<SysVarEntry>
					<Key>com.sysprogs.rtos_type</Key>
					<Value>com.sysprogs.threadx</Value>
				</SysVarEntry>
			</AdditionalSystemVars>
		</Framework>
		<Framework>
			<Name>AzureRTOS - FileX</Name>
			<ID>com.sysprogs.arm.stm32.filex</ID>
			<ProjectFolderName>FileX</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\filex</SourceFolder>
					<TargetFolder>AzureRTOS\filex</TargetFolder>
					<FilesToCopy>*</FilesToCopy>
					<Flags>IgnoreFamilySubdir</Flags>
					<AutoIncludeMask/>
					<ProjectInclusionMask>-common\drivers\template\*;common\*.c;common\*.h;ports\cortex_*\*.c;ports\cortex_*\*.h;</ProjectInclusionMask>
					<SmartPropertyGroup>com.sysprogs.bspoptions.stm32.filex.|FileX</SmartPropertyGroup>
					<ExcludeFromVendorSampleMapping>true</ExcludeFromVendorSampleMapping>
					<AdditionalIncludeDirs>common/inc;ports/cortex_$$com.sysprogs.bspoptions.arm.core$$/gnu/inc</AdditionalIncludeDirs>
					<SimpleFileConditions> 
						<string>ports\\cortex_m0\\.*:$$com.sysprogs.bspoptions.arm.core$$==M0</string>
						<string>ports\\cortex_m3\\.*:$$com.sysprogs.bspoptions.arm.core$$==M3</string>
						<string>ports\\cortex_m4\\.*:$$com.sysprogs.bspoptions.arm.core$$==M4</string>
						<string>ports\\cortex_m7\\.*:$$com.sysprogs.bspoptions.arm.core$$==M7</string>
					</SimpleFileConditions>
					<SmartFileConditions>
						<string>-NAND driver[levelx_nand]|.*\\fx_stm32_levelx_nand_driver\.(h|c)</string>
						<string>-NOR driver[levelx_nor]|.*\\fx_stm32_levelx_nor_driver\.(h|c)</string>
						<string>-MMC driver[mmc]|.*\\fx_stm32_mmc_driver\.(h|c)</string>
						<string>-SD driver[sd]|.*\\fx_stm32_sd_driver\.(h|c)</string>
						<string>-SRAM driver[sram]|.*\\fx_stm32_sram_driver\.(h|c)</string>
					</SmartFileConditions>
				</CopyJob>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\filex\ports\generic</SourceFolder>
					<TargetFolder>AzureRTOS\filex\ports\cortex_m33\gnu</TargetFolder>
					<Flags>IgnoreFamilySubdir</Flags>
					<FilesToCopy>*</FilesToCopy>
					<AutoIncludeMask/>
				</CopyJob>
			</CopyJobs>
		</Framework>
		<Framework>
			<Name>AzureRTOS - LevelX</Name>
			<ID>com.sysprogs.arm.stm32.levelx</ID>
			<ProjectFolderName>LevelX</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\levelx</SourceFolder>
					<TargetFolder>AzureRTOS\levelx</TargetFolder>
					<FilesToCopy>*</FilesToCopy>
					<AutoIncludeMask/>
					<Flags>AutoTrimFileConditions IgnoreFamilySubdir</Flags>
					<ProjectInclusionMask>-common\drivers\template\*;common\*.c;common\*.h;ports\cortex_*\*.c;ports\cortex_*\*.h;</ProjectInclusionMask>
					<SmartPropertyGroup>com.sysprogs.bspoptions.stm32.levelx.|LevelX</SmartPropertyGroup>
					<ExcludeFromVendorSampleMapping>true</ExcludeFromVendorSampleMapping>
					<AdditionalIncludeDirs>common/inc</AdditionalIncludeDirs>
					<SmartFileConditions>
						<string>-NAND simulator driver[nand_simulator]|.*\\lx_stm32_nand_simulator_driver\.(h|c)</string>
						<string>-NOR simulator driver[nor_simulator]|.*\\lx_stm32_nor_simulator_driver\.(h|c)</string>
						<string>-OSPI simulator driver[ospi]|.*\\lx_stm32_ospi_driver\.(h|c)</string>
						<string>-QSPI simulator driver[qspi]|.*\\lx_stm32_qspi_driver\.(h|c)</string>
						<string>-XSPI simulator driver[xspi]|common\\drivers\\lx_stm32_xspi_driver.*</string><!-- Auto-trimmable syntax -->
					</SmartFileConditions>
				</CopyJob>
			</CopyJobs>
		</Framework>
		<Framework>
			<Name>AzureRTOS - USBX</Name>
			<ID>com.sysprogs.arm.stm32.usbx</ID>
			<ProjectFolderName>USBX</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>
			<CopyJobs>
				<CopyJob>
					<SourceFolder>$$STM32:FAMILY_DIR$$\Middlewares\ST\usbx</SourceFolder>
					<TargetFolder>AzureRTOS\usbx</TargetFolder>
					<Flags>AutoTrimFileConditions IgnoreFamilySubdir</Flags>
					<FilesToCopy>*</FilesToCopy>
					<AutoIncludeMask>-ports*;-test*;*.h</AutoIncludeMask>
					<AdditionalIncludeDirs>ports/generic/inc</AdditionalIncludeDirs>
					<ProjectInclusionMask>common\*.c;common\*.h;ports\generic\*.h;</ProjectInclusionMask>
					<SmartPropertyGroup>com.sysprogs.bspoptions.stm32.usbx.|USBX</SmartPropertyGroup>
					<ExcludeFromVendorSampleMapping>true</ExcludeFromVendorSampleMapping>
					<SmartFileConditions>
						<string>-USB Host Support[host_controllers]|common\\usbx(|_stm32)_host_controllers\\.*</string>
						<string>-USB Device Support[device_controllers]|common\\usbx(|_stm32)_device_controllers\\.*</string>
						<string>-Network Support[network]|common\\usbx_network\\.*</string>
						<string>-Pictbridge Support[pictbridge]|common\\usbx_pictbridge\\.*</string>
						
						<string>-Audio Device Class[device_class_audio]|common\\usbx_device_classes\\src\\ux_device_class_audio.*</string>
						<string>-CCID Class[device_class_ccid]|common\\usbx_device_classes\\src\\ux_device_class_ccid.*</string>
						<string>-CDC ACM Device Class[device_class_cdc_acm]|common\\usbx_device_classes\\src\\ux_device_class_cdc_acm.*</string>
						<string>-CDC ECM Device Class[device_class_cdc_ecm]|common\\usbx_device_classes\\src\\ux_device_class_cdc_ecm.*</string>
						<string>-DFU Device Class[device_class_dfu]|common\\usbx_device_classes\\src\\ux_device_class_dfu.*</string>
						<string>-HID Device Class[device_class_hid]|common\\usbx_device_classes\\src\\ux_device_class_hid.*</string>
						<string>-PIMA Device Class[device_class_pima]|common\\usbx_device_classes\\src\\ux_device_class_pima.*</string>
						<string>-Printer Device Class[device_class_printer]|common\\usbx_device_classes\\src\\ux_device_class_printer.*</string>
						<string>-RNDIS Device Class[device_class_rndis]|common\\usbx_device_classes\\src\\ux_device_class_rndis.*</string>
						<string>-Storage Device Class[device_class_storage]|common\\usbx_device_classes\\src\\ux_device_class_storage.*</string>
						<string>-Video Device Class[device_class_video]|common\\usbx_device_classes\\src\\ux_device_class_video.*</string>

						<string>-ASIX Host Class[host_class_asix]|common\\usbx_host_classes\\src\\ux_host_class_asix.*</string>
						<string>-Audio Host Class[host_class_audio]|common\\usbx_host_classes\\src\\ux_host_class_audio.*</string>
						<string>-CDC_ACM Host Class[host_class_cdc_acm]|common\\usbx_host_classes\\src\\ux_host_class_cdc_acm.*</string>
						<string>-CDC_ECM Host Class[host_class_cdc_ecm]|common\\usbx_host_classes\\src\\ux_host_class_cdc_ecm.*</string>
						<string>-GSER Host Class[host_class_gser]|common\\usbx_host_classes\\src\\ux_host_class_gser.*</string>
						<string>-HID Host Class[host_class_hid]|common\\usbx_host_classes\\src\\ux_host_class_hid.*</string>
						<string>-Hub Host Class[host_class_hub]|common\\usbx_host_classes\\src\\ux_host_class_hub.*</string>
						<string>-PIMA Host Class[host_class_pima]|common\\usbx_host_classes\\src\\ux_host_class_pima.*</string>
						<string>-Printer Host Class[host_class_printer]|common\\usbx_host_classes\\src\\ux_host_class_printer.*</string>
						<string>-Prolific Host Class[host_class_prolific]|common\\usbx_host_classes\\src\\ux_host_class_prolific.*</string>
						<string>-Storage Host Class[host_class_storage]|common\\usbx_host_classes\\src\\ux_host_class_storage.*</string>
						<string>-SWAR Host Class[host_class_swar]|common\\usbx_host_classes\\src\\ux_host_class_swar.*</string>
						<string>-Video Host Class[host_class_video]|common\\usbx_host_classes\\src\\ux_host_class_video.*</string>
					</SmartFileConditions>
				</CopyJob>
			</CopyJobs>
		</Framework>
	</AdditionalFrameworks>	
</FamilyDefinition>
