<?xml version="1.0"?>
<FamilyDefinition xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
	<AdditionalFrameworks>
		<Framework>
			<Name>LibJPEG</Name>
			<ID>com.sysprogs.arm.stm32.LibJPEG</ID>
			<ConfigurationFileTemplates>
                <ConfigurationFileTemplate>
                        <SourcePath>$$SYS:BSP_ROOT$$/LibJPEG/include/jconfig_template.h</SourcePath>
                        <TargetFileName>jconfig.h</TargetFileName>
                        <ExpandMacros>false</ExpandMacros>
                 </ConfigurationFileTemplate>
               <ConfigurationFileTemplate>
                        <SourcePath>$$SYS:BSP_ROOT$$/LibJPEG/include/jmorecfg_template.h</SourcePath>
                        <TargetFileName>jmorecfg.h</TargetFileName>
                        <ExpandMacros>false</ExpandMacros>
                 </ConfigurationFileTemplate>
                <!--jan17 ConfigurationFileTemplate>
                        <SourcePath>$$SYS:BSP_ROOT$$/LibJPEG/include/jdatasrc_conf_template.h</SourcePath>
                        <TargetFileName>jdatasrc_conf.h</TargetFileName>
                        <ExpandMacros>false</ExpandMacros>
                 </ConfigurationFileTemplate-->
				  <!--jan17 ConfigurationFileTemplate>
                       <SourcePath>$$SYS:BSP_ROOT$$/LibJPEG/source/jdatasrc_conf_template.c</SourcePath>
                        <TargetFileName>jdatasrc_conf.c</TargetFileName>
                        <ExpandMacros>false</ExpandMacros>
                 </ConfigurationFileTemplate-->
			</ConfigurationFileTemplates>				
			<ProjectFolderName>LibJPEG</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
				<string>com.sysprogs.arm.stm32.fatfs</string>
			</RequiredFrameworks>		
			<CopyJobs>			
				<CopyJob>
					<SourceFolder>$$STM32:F7_DIR$$\Middlewares\Third_Party\LibJPEG</SourceFolder>
					<FilesToCopy>*.c;*.h;*.txt;*.bmp;*.jpg</FilesToCopy>
					<ProjectInclusionMask>-*jpegtran.c;-*jmemmac.c;-*jmemdos.c;-*jmemname.c;-*jmemansi.c;-*jdatasrc_conf_template.c;source\j*.c;*.h</ProjectInclusionMask>
					<AutoIncludeMask/>
					<AdditionalIncludeDirs>$$SYS:BSP_ROOT$$/LibJPEG/include</AdditionalIncludeDirs>
					<PreprocessorMacros></PreprocessorMacros>
					<SimpleFileConditions>
					</SimpleFileConditions>
					<Patches>
						<!--jan17 Patch xsi:type="ReplaceLine">
							<FilePath>source\jdatasrc_conf_template.c</FilePath>
							<OldLine>#include "jdatasrc_conf_template.h"</OldLine>
							<NewLine>#include "jdatasrc_conf.h"</NewLine>
						</Patch-->
					</Patches>
				</CopyJob>
				<CopyJob>
					<SourceFolder>$$BSPGEN:RULES_DIR$$\\config</SourceFolder>
					<FilesToCopy>jconfig.h</FilesToCopy>
					<TargetFolder>BSP\ConfigTemplates</TargetFolder>
					<ProjectInclusionMask>*.h</ProjectInclusionMask>				
				</CopyJob>
			</CopyJobs>
		</Framework>	
		<Framework>
			<Name>PolarSSL</Name>
			<ID>com.sysprogs.arm.stm32.PolarSSL</ID>
			     <ConfigurationFileTemplates>
                    <ConfigurationFileTemplate>
                        <SourcePath>$$SYS:BSP_ROOT$$/PolarSSL/include/polarssl/_config.h</SourcePath>
                        <TargetFileName>config.h</TargetFileName>
                        <ExpandMacros>false</ExpandMacros>
                        </ConfigurationFileTemplate>
					</ConfigurationFileTemplates>	
			<ProjectFolderName>PolarSSL</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>		
			<CopyJobs>			
				<CopyJob>
					<SourceFolder>$$BSPGEN:INPUT_DIR$$\PolarSSL</SourceFolder>
					<FilesToCopy>*.c;*.h;*.txt</FilesToCopy>
					<ProjectInclusionMask>-programs\*;-tests\*;-visualc\*;-scripts\*;-doxygen\*;*.c;*.h</ProjectInclusionMask>
					<AutoIncludeMask/>
					<AdditionalIncludeDirs>$$SYS:BSP_ROOT$$/PolarSSL/include;$$SYS:BSP_ROOT$$/PolarSSL/include/polarssl</AdditionalIncludeDirs>
					<PreprocessorMacros></PreprocessorMacros>
					<AdvancedRenameRules>library\\(arc4|des|md4|md5|sha1)\.c$=>PolarSSL_{1}.c</AdvancedRenameRules>
				</CopyJob>
			</CopyJobs>
		</Framework>	
		<Framework>
			<Name>FatFs</Name>
			<ID>com.sysprogs.arm.stm32.FatFs</ID>
               <ConfigurationFileTemplates>
                    <ConfigurationFileTemplate>
                        <SourcePath>$$SYS:BSP_ROOT$$/FatFs/src/ffconf_template.h</SourcePath>
                        <TargetFileName>ffconf.h</TargetFileName>
                        <ExpandMacros>false</ExpandMacros>
                        </ConfigurationFileTemplate>
					</ConfigurationFileTemplates>				  
			<ProjectFolderName>FatFs</ProjectFolderName>
			<DefaultEnabled>false</DefaultEnabled>
			<RequiredFrameworks>
				<string>com.sysprogs.arm.stm32.hal</string>
			</RequiredFrameworks>		
			<CopyJobs>			
				<CopyJob>
					<SourceFolder>$$STM32:F7_DIR$$\Middlewares\Third_Party\FatFs</SourceFolder>
					<FilesToCopy>*.c;*.h;*.txt</FilesToCopy>
					<ProjectInclusionMask>-src\drivers\*;-src\option\cc*.c;-doc\*;*.c;*.h</ProjectInclusionMask>
					<AutoIncludeMask/>
					<AdditionalIncludeDirs>$$SYS:BSP_ROOT$$/FatFs/src;$$SYS:BSP_ROOT$$/FatFs/src/drivers</AdditionalIncludeDirs>
					<PreprocessorMacros></PreprocessorMacros>
				</CopyJob>
				<CopyJob>
					<SourceFolder>$$BSPGEN:RULES_DIR$$\\config</SourceFolder>
					<FilesToCopy>ffconf.h</FilesToCopy>
					<TargetFolder>BSP\ConfigTemplates</TargetFolder>
					<AutoIncludeMask/>
					<AdditionalIncludeDirs>$$SYS:BSP_ROOT$$/STM32F7xxxx/BSP/STM32756G_EVAL</AdditionalIncludeDirs>
					<ProjectInclusionMask>*.h</ProjectInclusionMask>				
				</CopyJob>
			</CopyJobs>
		</Framework>		
	</AdditionalFrameworks>
	<SmartSamples>
		<SmartSample>
			<SourceFolder>$$BSPGEN:RULES_DIR$$\samples\HTTP_Netconn_STM32F2X</SourceFolder>
			<DestinationFolder>samples\HTTP_Netconn_STM32F2X</DestinationFolder>
			<AdditionalBuildTimeSources>
				<string>$$STM32:F2_DIR$$\Projects\NUCLEO-F207ZG\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Src\ethernetif.c</string>
				<string>$$STM32:F2_DIR$$\Projects\NUCLEO-F207ZG\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\ethernetif.h</string>
				<string>$$STM32:F2_DIR$$\Projects\NUCLEO-F207ZG\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\FreeRTOSConfig.h</string>
				<string>$$STM32:F2_DIR$$\Projects\NUCLEO-F207ZG\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\lwipopts.h</string>
				<string>$$STM32:F2_DIR$$\Projects\NUCLEO-F207ZG\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\stm32f2xx_hal_conf.h</string>
				<string>$$STM32:F2_DIR$$\Projects\NUCLEO-F207ZG\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\src\system_stm32f2xx.c</string>
			</AdditionalBuildTimeSources>
			<Patches>
				<Patch xsi:type="ReplaceLine">
					<FilePath>FreeRTOSConfig.h</FilePath>
					<OldLine> #define configTOTAL_HEAP_SIZE			( ( size_t ) ( 25 * 1024 ) )</OldLine>
					<NewLine> #define configTOTAL_HEAP_SIZE			( ( size_t ) ( 32 * 1024 ) )</NewLine>
				</Patch>
				<Patch xsi:type="ReplaceLine">
					<FilePath>lwipopts.h</FilePath>
					<OldLine>#define HTTPD_USE_CUSTOM_FSDATA   1</OldLine>
					<NewLine>#define HTTPD_USE_CUSTOM_FSDATA   0</NewLine>
				</Patch>
			</Patches>
		</SmartSample>
		<SmartSample>
			<SourceFolder>$$BSPGEN:RULES_DIR$$\samples\HTTP_Netconn_STM32F4X</SourceFolder>
			<DestinationFolder>samples\HTTP_Netconn_STM32F4X</DestinationFolder>
			<AdditionalBuildTimeSources>
				<string>$$STM32:F4_DIR$$\Projects\STM32F429ZI-Nucleo\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Src\ethernetif.c</string>
				<string>$$STM32:F4_DIR$$\Projects\STM32F429ZI-Nucleo\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\ethernetif.h</string>
				<string>$$STM32:F4_DIR$$\Projects\STM32F429ZI-Nucleo\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\FreeRTOSConfig.h</string>
				<string>$$STM32:F4_DIR$$\Projects\STM32F429ZI-Nucleo\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\lwipopts.h</string>
				<string>$$STM32:F4_DIR$$\Projects\STM32F429ZI-Nucleo\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\stm32f4xx_hal_conf.h</string>
				<string>$$STM32:F4_DIR$$\Projects\STM32F429ZI-Nucleo\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\src\system_stm32f4xx.c</string>
			</AdditionalBuildTimeSources>
			<Patches>
				<Patch xsi:type="ReplaceLine">
					<FilePath>FreeRTOSConfig.h</FilePath>
					<OldLine> #define configTOTAL_HEAP_SIZE			( ( size_t ) ( 25 * 1024 ) )</OldLine>
					<NewLine> #define configTOTAL_HEAP_SIZE			( ( size_t ) ( 32 * 1024 ) )</NewLine>
				</Patch>
				<Patch xsi:type="ReplaceLine">
					<FilePath>lwipopts.h</FilePath>
					<OldLine>#define HTTPD_USE_CUSTOM_FSDATA   1</OldLine>
					<NewLine>#define HTTPD_USE_CUSTOM_FSDATA   0</NewLine>
				</Patch>
				<Patch xsi:type="ReplaceLine">
					<FilePath>ethernetif.c</FilePath>
					<OldLine>#include "../Components/lan8742/lan8742.h"</OldLine>
					<NewLine>#include "lan8742.h"</NewLine>
				</Patch>
				<Patch xsi:type="ReplaceLine">
					<FilePath>ethernetif.c</FilePath>
					<OldLine>    Txbuffer[i].buffer = q->payload;</OldLine>
					<NewLine>    Txbuffer[i].buffer = (uint8_t*)q->payload;</NewLine>
				</Patch>
					<Patch xsi:type="ReplaceLine">
					<FilePath>ethernetif.c</FilePath>
					<OldLine>  struct pbuf_custom *p = LWIP_MEMPOOL_ALLOC(RX_POOL);</OldLine>
					<NewLine>  struct pbuf_custom *p = (struct pbuf_custom *)LWIP_MEMPOOL_ALLOC(RX_POOL);</NewLine>
				</Patch>
			</Patches>
		</SmartSample>
		<SmartSample>
			<SourceFolder>$$BSPGEN:RULES_DIR$$\samples\HTTP_Netconn_STM32F7X</SourceFolder>
			<DestinationFolder>samples\HTTP_Netconn_STM32F7X</DestinationFolder>
			<AdditionalBuildTimeSources>
				<string>$$STM32:F7_DIR$$\Projects\STM32746G-Discovery\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Src\ethernetif.c</string>
				<string>$$STM32:F7_DIR$$\Projects\STM32746G-Discovery\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\ethernetif.h</string>
				<string>$$STM32:F7_DIR$$\Projects\STM32746G-Discovery\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\FreeRTOSConfig.h</string>
				<string>$$STM32:F7_DIR$$\Projects\STM32746G-Discovery\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\lwipopts.h</string>
				<string>$$STM32:F7_DIR$$\Projects\STM32746G-Discovery\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\Inc\stm32f7xx_hal_conf.h</string>
				<string>$$STM32:F7_DIR$$\Projects\STM32746G-Discovery\Applications\LwIP\LwIP_HTTP_Server_Netconn_RTOS\src\system_stm32f7xx.c</string>
			</AdditionalBuildTimeSources>
			<Patches>
				<Patch xsi:type="ReplaceLine">
					<FilePath>FreeRTOSConfig.h</FilePath>
					<OldLine> #define configTOTAL_HEAP_SIZE			( ( size_t ) ( 25 * 1024 ) )</OldLine>
					<NewLine> #define configTOTAL_HEAP_SIZE			( ( size_t ) ( 32 * 1024 ) )</NewLine>
				</Patch>
				<Patch xsi:type="ReplaceLine">
					<FilePath>lwipopts.h</FilePath>
					<OldLine>#define HTTPD_USE_CUSTOM_FSDATA   1</OldLine>
					<NewLine>#define HTTPD_USE_CUSTOM_FSDATA   0</NewLine>
				</Patch>
				<Patch xsi:type="ReplaceLine">
					<FilePath>ethernetif.c</FilePath>
					<OldLine>#include "../Components/lan8742/lan8742.h"</OldLine>
					<NewLine>#include "lan8742.h"</NewLine>
				</Patch>
				<Patch xsi:type="ReplaceLine">
					<FilePath>ethernetif.c</FilePath>
					<OldLine>    Txbuffer[i].buffer = q->payload;</OldLine>
					<NewLine>    Txbuffer[i].buffer = (uint8_t*)q->payload;</NewLine>
				</Patch>
					<Patch xsi:type="ReplaceLine">
					<FilePath>ethernetif.c</FilePath>
					<OldLine>  struct pbuf_custom *p = LWIP_MEMPOOL_ALLOC(RX_POOL);</OldLine>
					<NewLine>  struct pbuf_custom *p = (struct pbuf_custom *)LWIP_MEMPOOL_ALLOC(RX_POOL);</NewLine>
				</Patch>
			</Patches>
		</SmartSample>
		<SmartSample>
			<SourceFolder>$$BSPGEN:RULES_DIR$$\samples\LEDBlink</SourceFolder>
			<DestinationFolder>samples\LEDBlink</DestinationFolder>
			<AdditionalSources>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_system_file$$</string>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_config_template_file$$=>$$com.sysprogs.stm32.hal_header_prefix$$_hal_conf.h</string>
			</AdditionalSources>
		</SmartSample>
		<SmartSample>
			<SourceFolder>$$BSPGEN:RULES_DIR$$\samples\LEDBlink_LL</SourceFolder>
			<DestinationFolder>samples\LEDBlink_LL</DestinationFolder>
			<AdditionalSources>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_system_file$$</string>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_config_template_file$$=>$$com.sysprogs.stm32.hal_header_prefix$$_hal_conf.h</string>
			</AdditionalSources>
		</SmartSample>
		<SmartSample>
			<SourceFolder>$$BSPGEN:RULES_DIR$$\samples\UnitTests\TestHAL</SourceFolder>
			<DestinationFolder>samples\UnitTests\TestHAL</DestinationFolder>
			<IsTestProjectSample>true</IsTestProjectSample>
			<AdditionalSources>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_system_file$$</string>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_config_template_file$$=>$$com.sysprogs.stm32.hal_header_prefix$$_hal_conf.h</string>
			</AdditionalSources>
		</SmartSample>
		<SmartSample>
			<SourceFolder>$$BSPGEN:RULES_DIR$$\samples\FreeRTOS</SourceFolder>
			<DestinationFolder>samples\FreeRTOS</DestinationFolder>
			<AdditionalSources>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_system_file$$</string>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_config_template_file$$=>$$com.sysprogs.stm32.hal_header_prefix$$_hal_conf.h</string>
			</AdditionalSources>
		</SmartSample>
		<SmartSample>
			<SourceFolder>$$BSPGEN:RULES_DIR$$\samples\AzureRTOS</SourceFolder>
			<DestinationFolder>samples\AzureRTOS</DestinationFolder>
			<AdditionalSources>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_system_file$$</string>
				<string>$$SYS:BSP_ROOT$$/$$com.sysprogs.bspoptions.stm32.hal_config_template_file$$=>$$com.sysprogs.stm32.hal_header_prefix$$_hal_conf.h</string>
			</AdditionalSources>
		</SmartSample>
	</SmartSamples>
	<InitializationCodeInsertionPoints>
		<CodeInsertionPoint>
			<Regex>int[ \t]+main[ \t]*\([ \t]*(void|)[ \t]*\)[ \t\r\n]*\{[^\}]+\n([ \t]+)(HAL_Init[ \t]*\([ \t]*\);)[ \t\r]*\n([ \t]+)(SystemClock_Config[ \t]*\([ \t]*\);)</Regex>
			<InitGroupNumber>5</InitGroupNumber>
			<InsertAfterGroup>true</InsertAfterGroup>
			<IndentationGroupNumber>4</IndentationGroupNumber>
		</CodeInsertionPoint>	
		<CodeInsertionPoint>
			<Regex>int[ \t]+main[ \t]*\([ \t]*(void|)[ \t]*\)[ \t\r\n]*\{[^\}]+\n([ \t]+)(HAL_Init[ \t]*\([ \t]*\);)</Regex>
			<InitGroupNumber>3</InitGroupNumber>
			<IndentationGroupNumber>2</IndentationGroupNumber>
			<InsertAfterGroup>true</InsertAfterGroup>
		</CodeInsertionPoint>
	</InitializationCodeInsertionPoints>
</FamilyDefinition>
